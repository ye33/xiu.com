"use strict";function reg(){$("#welcome").html(logname+"&nbsp;您好&nbsp;欢迎光临走秀网!"),$("#status").html("退出"),$("#status").prop("href","#"),$("#status").prop("title","[退出]")}function exit(){$("#welcome").html("&nbsp;您好!&nbsp;欢迎光临走秀网!"),$("#status").html("[登录/注册]"),$("#status").prop("href","../html/reg.html"),$("#status").prop("title","登录/注册")}if(Cookie.get("username")){var logname=Cookie.get("username");console.log(logname),reg()}else exit();$("#status").on("click",function(){if("退出"==$(this).text()){var n=new Date;n.setDate(n.getDate()-1),Cookie.set("username","no",{expires:n,path:"/Xiu/this-xiu/src"}),location.href("cart.html")}});var arr=[],delarr=[];function create(n){var t=JSON.parse(n);console.log(t);var e=t.map(function(n){return'<div class="item" data-id="'+n.id+'">\n                    \t<ul class="clearfix">\n        \t\t\t\t<li class="pick">\n                            <input type="checkbox" />\n                        </li>\n                        <li class="infor">\n                            <img src="'+n.imgurl+'" alt="" />\n                            <p>'+n.brand+"</p>\n                            <p>"+n.name+"</p>\n                            <p>颜色 : "+n.color+" 尺码 : "+n.size+'</p>\n                        </li>\n                        <li class="pric">\n                            <p>¥&nbsp;'+n.price+'</p>\n                            <p class="good_total">¥&nbsp;'+n.original+'</p>\n                        </li>\n                        <li class="number">\n                            <span class="cut">-</span>\n                            <input class="num"type="text" value="'+n.number+'"/>\n                            <span class="add">+</span>\n                        </li>\n                        <li class="done">\n                            <a class="like" href="javascript:;">移至收藏夹</a>\n                            <a class="del" href="javascript:;">删除</a>\n                        </li>\n                           </ul>\n           \t\t\t</div>'}).join("");$("#goodLis").html($("#goodLis").html()+e),$(".pick input").prop("checked","checked"),changeColor(),countNum()}function changeColor(){for(var n=0;n<$(".pick input").size();n++)console.log(12345),$(".pick input").eq(n).prop("checked")?(console.log(12345),$(".pick input").eq(n).parent().parent().parent().css("background","#fff4e8")):$(".pick input").eq(n).parent().parent().parent().css("background","")}function _require(n){var t=n.parent().parent().parent().attr("data-id"),e=n.parent().find("input").val();$.ajax({type:"get",url:"../api/update.php",async:!0,data:{id:t,number:e},success:function(n){console.log(n)}}),countNum()}$.ajax({type:"get",url:"../api/checkcart.php",async:!0,data:{},success:function(n){create(n),update()}}),$("#goodLis").on("click",".add",function(){var n=$(this).prev().val();10<=++n&&(n=10),$(this).prev().val(n),_require($(this)),countNum()}),$("#goodLis").on("click",".cut",function(){var n=$(this).next().val();--n<=1&&(n=1),$(this).next().val(n),_require($(this)),countNum()}),$("#goodLis").on("click",".del",function(){var n=$(this).parent().parent().parent().data("id");confirm("您确定要删除该商品吗？")&&($(this).parent().parent().parent().remove(),$.ajax({type:"get",url:"../api/delete.php",async:!0,data:{id:n},success:function(n){console.log(n)}})),countNum(),update(),changeColor()});var selectAll=$("#count").find("input"),isok=!1;function update(){0==$(".pick").size()?($("#count").css("display","none"),$("#cartHead").css("display","none")):($("#count").css("display","block"),$("#cartHead").css("display","block"))}function countNum(){delarr.length=0,arr.length=0;for(var n=$(".pick input").size(),t=0;t<n;t++)if($(".pick input").eq(t).prop("checked")){var e=$(".pick").eq(t).parent().parent().data("id");arr.push(t),delarr.push(e)}console.log(arr),console.log(delarr);var o=0,a=0;for(t=0;t<arr.length;t++){var c=$(".good_total").eq(arr[t]).text();a+=(c=1*$.trim(c).substring(2))*(o+=1*$(".num").eq(arr[t]).val())}$("#allnum").html("已选商品&nbsp;<span>"+o+"</span>&nbsp;件"),$("#totalprice").html("总计（不含运费）：<span>￥"+a.toFixed(2)+"</span>")}selectAll.on("click",function(){isok?$(".pick input").prop("checked","checked"):$(".pick input").prop("checked",""),isok=!isok,countNum(),changeColor()}),update(),$("#goodLis").on("click",".pick input",function(){countNum(),isok=$(".pick input").size()==arr.length?($("#count input").prop("checked","checked"),!1):($("#count input").removeAttr("checked"),!0),changeColor()}),$("#count input").prop("checked","checked"),countNum(),$("#delall").on("click",function(){if(countNum(),confirm("您确定要删除所选商品吗？")){for(var n=arr.length-1;0<=n;n--)$.ajax({type:"get",url:"../api/delete.php",async:!0,data:{id:delarr[n]},success:function(n){console.log(n)}}),$(".pick").parent().parent().eq(arr[n]).remove();changeColor(),countNum(),update()}}),$("#goodLis").on("change",".num",function(){_require($(this)),countNum()}),$("#goodLis").on("mouseover",".done>a",function(){console.log(123),$(this).css("color","#EB7416")}),$("#goodLis").on("mouseout",".done>a",function(){$(this).css("color","#5B5B5B")}),$("#count a").hover(function(){$(this).addClass("thisActive")},function(){$(this).removeClass("thisActive")}),$(window).scroll(function(){300<=$(window).scrollTop()?$("#count").addClass("fixBottom"):$("#count").removeClass("fixBottom")});